
> harvestpro-nz@4.2.1 test
> vitest run --run


[1m[46m RUN [49m[22m [36mv4.0.18 [39m[90mC:/Users/ibrab/Downloads/app/harvestpro-nz (1)[39m

 [32mÔ£ô[39m src/hooks/usePickerStatus.test.ts [2m([22m[2m5 tests[22m[2m)[22m[32m 5[2mms[22m[39m
 [32mÔ£ô[39m src/hooks/useCalculations.test.ts [2m([22m[2m11 tests[22m[2m)[22m[32m 11[2mms[22m[39m
 [32mÔ£ô[39m src/services/validation.service.test.ts [2m([22m[2m27 tests[22m[2m)[22m[32m 12[2mms[22m[39m
 [32mÔ£ô[39m src/services/compliance.service.test.ts [2m([22m[2m21 tests[22m[2m)[22m[32m 9[2mms[22m[39m
node.exe : 
[90mstderr[2m | s
rc/stores/__tests__
/useHarvestStore.te
st.ts[2m > [22m[
2museHarvestStore 
- Phase 9 
Validations[2m > 
[22m[2maddBucket 
- Attendance 
Validation[2m > 
[22m[2mrejects 
bucket if picker 
not checked in
En línea: 1 
Carácter: 1
+ & "C:\Program Fil
es\nodejs/node.exe"
 "C:\Program Files\
nodejs/node_mo ...
+ ~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~
    + CategoryInfo 
             : No  
  tSpecified: (   
 [90mstderr[2m    
... not checke    
d in:String) [    
], RemoteExcep    
tion
    + FullyQualifi 
   edErrorId : Na  
  tiveCommandErr   
 or
 
[22m[39m?? 
[Store] REJECTED 
ÔÇö picker 
Unchecked Picker 
not checked in 
today (cache)

[90mstderr[2m | s
rc/stores/__tests__
/useHarvestStore.te
st.ts[2m > [22m[
2museHarvestStore 
- Phase 9 
Validations[2m > 
[22m[2maddBucket 
- Attendance 
Validation[2m > 
[22m[2maccepts 
bucket if picker 
checked in
[22m[39mUnhandled
 rejection: 
MissingAPIError: 
IndexedDB API 
missing. Please 
visit https://tinyu
rl.com/y2uuvskb
    at processTicks
AndRejections (node
:internal/process/t
ask_queues:103:5)
From previous: 
    at processTicks
AndRejections (node
:internal/process/t
ask_queues:103:5)

[90mstderr[2m | s
rc/stores/__tests__
/useHarvestStore.te
st.ts[2m > [22m[
2museHarvestStore 
- Phase 9 
Validations[2m > 
[22m[2maddBucket 
- Attendance 
Validation[2m > 
[22m[2maccepts 
bucket if picker 
checked in
[22m[39m├ó┬Ø┼Æ 
[Offline] Failed 
to queue bucket: 
[36m<ref *2>[39m 
DexieError [Databas
eClosedError]: 
MissingAPIError 
IndexedDB API 
missing. Please 
visit https://tinyu
rl.com/y2uuvskb
[90m    at process
TicksAndRejections 
(node:internal/proc
ess/task_queues:103
:5)[39m
From previous: 
    at 
Object.queueBucket 
(C:/Users/ibrab/Dow
nloads/app/harvestp
ro-nz (1)/src/servi
ces/offline.service
.ts:13:29)
    at 
Object.addBucket (C
:/Users/ibrab/Downl
oads/app/harvestpro
-nz (1)/src/stores/
useHarvestStore.ts:
305:32)
    at C:/Users/ibr
ab/Downloads/app/ha
rvestpro-nz (1)/src
/stores/__tests__/u
seHarvestStore.test
.ts:83:32
    at [90mC:\User
s\ibrab\Downloads\a
pp\harvestpro-nz (1
)\[39mnode_modules
\[4m@testing-libra
ry\react[24m\dist\
act-compat.js:47:24
From previous: 
    at new 
HarvestDB (C:/Users
/ibrab/Downloads/ap
p/harvestpro-nz (1)
/src/services/db.ts
:49:9)
    at C:/Users/ibr
ab/Downloads/app/ha
rvestpro-nz (1)/src
/services/db.ts:60:
19
[90m    at process
TicksAndRejections 
(node:internal/proc
ess/task_queues:103
:5)[39m
    at VitestModule
Evaluator._runInlin
edModule [90m(file
:///C:/Users/ibrab/
Downloads/app/harve
stpro-nz%20(1)/[39
mnode_modules/[4mv
itest[24m/dist/mod
ule-evaluator.js:19
6:4[90m)[39m
    at VitestModule
Runner.directReques
t [90m(file:///C:/
Users/ibrab/Downloa
ds/app/harvestpro-n
z%20(1)/[39mnode_m
odules/[4mvite[24
m/dist/node/module-
runner.js:1146:59[
90m)[39m
    at VitestModule
Runner.cachedReques
t [90m(file:///C:/
Users/ibrab/Downloa
ds/app/harvestpro-n
z%20(1)/[39mnode_m
odules/[4mvite[24
m/dist/node/module-
runner.js:1053:73[
90m)[39m
    at C:/Users/ibr
ab/Downloads/app/ha
rvestpro-nz (1)/src
/services/offline.s
ervice.ts:1:2 {
  _e: Error: 
      at 
getErrorWithStack 
[90m(C:\Users\ibrab
\Downloads\app\harv
estpro-nz (1)\[39m
node_modules\[4mde
xie[24m\dist\dexie
.js:324:16[90m)[3
9m
      at new 
DexieError [90m(C:
\Users\ibrab\Downlo
ads\app\harvestpro-
nz (1)\[39mnode_mo
dules\[4mdexie[24
m\dist\dexie.js:423
:23[90m)[39m
      at 
tempTransaction [9
0m(C:\Users\ibrab\D
ownloads\app\harves
tpro-nz (1)\[39mno
de_modules\[4mdexi
e[24m\dist\dexie.j
s:1256:34[90m)[39
m
      at [90mC:\Us
ers\ibrab\Downloads
\app\harvestpro-nz 
(1)\[39mnode_modul
es\[4mdexie[24m\d
ist\dexie.js:1263:7
1
      at [90mC:\Us
ers\ibrab\Downloads
\app\harvestpro-nz 
(1)\[39mnode_modul
es\[4mdexie[24m\d
ist\dexie.js:1204:2
7
      at 
callListener [90m(
C:\Users\ibrab\Down
loads\app\harvestpr
o-nz (1)\[39mnode_
modules\[4mdexie[
24m\dist\dexie.js:9
26:23[90m)[39m
      at 
endMicroTickScope 
[90m(C:\Users\ibrab
\Downloads\app\harv
estpro-nz (1)\[39m
node_modules\[4mde
xie[24m\dist\dexie
.js:998:29[90m)[3
9m
      at 
physicalTick [90m(
C:\Users\ibrab\Down
loads\app\harvestpr
o-nz (1)\[39mnode_
modules\[4mdexie[
24m\dist\dexie.js:9
81:34[90m)[39m
  [90m    at proce
ssTicksAndRejection
s (node:internal/pr
ocess/task_queues:1
03:5)[39m,
  inner: [36m<ref 
*1>[39m 
DexieError 
[MissingAPIError]: 
IndexedDB API 
missing. Please 
visit https://tinyu
rl.com/y2uuvskb
  [90m    at proce
ssTicksAndRejection
s (node:internal/pr
ocess/task_queues:1
03:5)[39m
  From previous: 
  [90m    at proce
ssTicksAndRejection
s (node:internal/pr
ocess/task_queues:1
03:5)[39m {
    _e: Error: 
        at 
getErrorWithStack 
[90m(C:\Users\ibrab
\Downloads\app\harv
estpro-nz (1)\[39m
node_modules\[4mde
xie[24m\dist\dexie
.js:324:16[90m)[3
9m
        at new 
DexieError [90m(C:
\Users\ibrab\Downlo
ads\app\harvestpro-
nz (1)\[39mnode_mo
dules\[4mdexie[24
m\dist\dexie.js:423
:23[90m)[39m
        at [90mC:\
Users\ibrab\Downloa
ds\app\harvestpro-n
z (1)\[39mnode_mod
ules\[4mdexie[24m
\dist\dexie.js:3747
:23
        at 
executePromiseTask 
[90m(C:\Users\ibra
b\Downloads\app\har
vestpro-nz (1)\[39
mnode_modules\[4md
exie[24m\dist\dexi
e.js:840:13[90m)[
39m
        at new 
DexiePromise [90m(
C:\Users\ibrab\Down
loads\app\harvestpr
o-nz (1)\[39mnode_
modules\[4mdexie[
24m\dist\dexie.js:6
54:9[90m)[39m
        at 
tryOpenDB [90m(C:\
Users\ibrab\Downloa
ds\app\harvestpro-n
z (1)\[39mnode_mod
ules\[4mdexie[24m
\dist\dexie.js:3744
:46[90m)[39m
    [90m    at pro
cessTicksAndRejecti
ons (node:internal/
process/task_queues
:103:5)[39m,
    inner: 
[1mnull[22m,
    _promise: 
DexiePromise 
[Dexie.Promise] {
      _listeners: 
[],
      onuncatched: 
[36m[Function: 
nop][39m,
      _lib: 
[33mfalse[39m,
      _PSD: 
[36m[Object][39m,
      
_stackHolder: 
Error: 
          at 
getErrorWithStack 
[90m(C:\Users\ibrab
\Downloads\app\harv
estpro-nz (1)\[39m
node_modules\[4mde
xie[24m\dist\dexie
.js:324:16[90m)[3
9m
          at new 
DexiePromise [90m(
C:\Users\ibrab\Down
loads\app\harvestpr
o-nz (1)\[39mnode_
modules\[4mdexie[
24m\dist\dexie.js:6
38:33[90m)[39m
          at 
tryOpenDB [90m(C:\
Users\ibrab\Downloa
ds\app\harvestpro-n
z (1)\[39mnode_mod
ules\[4mdexie[24m
\dist\dexie.js:3744
:46[90m)[39m
      [90m    at p
rocessTicksAndRejec
tions (node:interna
l/process/task_queu
es:103:5)[39m,
      _prev: 
[1mnull[22m,
      _numPrev: 
[33m0[39m,
      _state: 
[33mfalse[39m,
      _value: 
[36m[Circular 
*1][39m,
      _stack: [32m
'MissingAPIError: 
IndexedDB API 
missing. Please 
visit https://tinyu
rl.com/y2uuvskb\n'
[39m +
        [32m'    
at processTicksAndR
ejections (node:int
ernal/process/task_
queues:103:5)\n'[3
9m +
        [32m'From 
previous: \n'[39m 
+
        [32m'    
at processTicksAndR
ejections (node:int
ernal/process/task_
queues:103:5)'[39m
    },
    _stack: [32m'M
issingAPIError: 
IndexedDB API 
missing. Please 
visit https://tinyu
rl.com/y2uuvskb\n'
[39m +
      [32m'    at 
processTicksAndReje
ctions (node:intern
al/process/task_que
ues:103:5)'[39m
  },
  _promise: 
DexiePromise 
[Dexie.Promise] {
    _listeners: [],
    onuncatched: 
[36m[Function: 
nop][39m,
    _lib: 
[33mfalse[39m,
    _PSD: {
      id: 
[32m'global'[39m,
      global: 
[33mtrue[39m,
      ref: 
[33m4[39m,
      unhandleds: 
[],
      onunhandled: 
[36m[Function: 
globalError][39m,
      pgp: 
[33mfalse[39m,
      env: 
[36m[Object][39m,
      finalize: 
[36m[Function: 
finalize][39m
    },
    _stackHolder: 
Error: 
        at 
getErrorWithStack 
[90m(C:\Users\ibrab
\Downloads\app\harv
estpro-nz (1)\[39m
node_modules\[4mde
xie[24m\dist\dexie
.js:324:16[90m)[3
9m
        at new 
DexiePromise [90m(
C:\Users\ibrab\Down
loads\app\harvestpr
o-nz (1)\[39mnode_
modules\[4mdexie[
24m\dist\dexie.js:6
38:33[90m)[39m
        at 
DexiePromise.then 
[90m(C:\Users\ibrab
\Downloads\app\harv
estpro-nz (1)\[39m
node_modules\[4mde
xie[24m\dist\dexie
.js:663:26[90m)[3
9m
        at 
tempTransaction [9
0m(C:\Users\ibrab\D
ownloads\app\harves
tpro-nz (1)\[39mno
de_modules\[4mdexi
e[24m\dist\dexie.j
s:1263:45[90m)[39
m
        at 
Table._trans [90m(
C:\Users\ibrab\Down
loads\app\harvestpr
o-nz (1)\[39mnode_
modules\[4mdexie[
24m\dist\dexie.js:1
349:21[90m)[39m
        at 
Table.put [90m(C:\
Users\ibrab\Downloa
ds\app\harvestpro-n
z (1)\[39mnode_mod
ules\[4mdexie[24m
\dist\dexie.js:1533
:25[90m)[39m
        at 
Object.queueBucket 
(C:/Users/ibrab/Dow
nloads/app/harvestp
ro-nz (1)/src/servi
ces/offline.service
.ts:13:29)
        at 
Object.addBucket (C
:/Users/ibrab/Downl
oads/app/harvestpro
-nz (1)/src/stores/
useHarvestStore.ts:
305:32)
        at C:/Users
/ibrab/Downloads/ap
p/harvestpro-nz (1)
/src/stores/__tests
__/useHarvestStore.
test.ts:83:32
        at [90mC:\
Users\ibrab\Downloa
ds\app\harvestpro-n
z (1)\[39mnode_mod
ules\[4m@testing-l
ibrary\react[24m\d
ist\act-compat.js:4
7:24,
    _prev: 
DexiePromise 
[Dexie.Promise] {
      _listeners: 
[],
      onuncatched: 
[36m[Function: 
nop][39m,
      _lib: 
[33mfalse[39m,
      _PSD: 
[36m[Object][39m,
      
_stackHolder: 
Error: 
          at 
getErrorWithStack 
[90m(C:\Users\ibrab
\Downloads\app\harv
estpro-nz (1)\[39m
node_modules\[4mde
xie[24m\dist\dexie
.js:324:16[90m)[3
9m
          at new 
DexiePromise [90m(
C:\Users\ibrab\Down
loads\app\harvestpr
o-nz (1)\[39mnode_
modules\[4mdexie[
24m\dist\dexie.js:6
38:33[90m)[39m
          at new 
Dexie [90m(C:\User
s\ibrab\Downloads\a
pp\harvestpro-nz (1
)\[39mnode_modules
\[4mdexie[24m\dis
t\dexie.js:4633:36
[90m)[39m
          at new 
HarvestDB (C:/Users
/ibrab/Downloads/ap
p/harvestpro-nz (1)
/src/services/db.ts
:49:9)
          at C:/Use
rs/ibrab/Downloads/
app/harvestpro-nz (
1)/src/services/db.
ts:60:19
      [90m    at p
rocessTicksAndRejec
tions (node:interna
l/process/task_queu
es:103:5)[39m
          at Vitest
ModuleEvaluator._ru
nInlinedModule [90
m(file:///C:/Users/
ibrab/Downloads/app
/harvestpro-nz%20(1
)/[39mnode_modules
/[4mvitest[24m/di
st/module-evaluator
.js:196:4[90m)[39
m
          at Vitest
ModuleRunner.direct
Request [90m(file:
///C:/Users/ibrab/D
ownloads/app/harves
tpro-nz%20(1)/[39m
node_modules/[4mvi
te[24m/dist/node/m
odule-runner.js:114
6:59[90m)[39m
          at Vitest
ModuleRunner.cached
Request [90m(file:
///C:/Users/ibrab/D
ownloads/app/harves
tpro-nz%20(1)/[39m
node_modules/[4mvi
te[24m/dist/node/m
odule-runner.js:105
3:73[90m)[39m
          at C:/Use
rs/ibrab/Downloads/
app/harvestpro-nz (
1)/src/services/off
line.service.ts:1:2
,
      _prev: 
[1mnull[22m,
      _numPrev: 
[33m0[39m,
      _state: 
[33mtrue[39m,
      _value: 
[90mundefined[39m
    },
    _numPrev: 
[33m1[39m,
    _state: 
[33mfalse[39m,
    _value: 
[36m[Circular 
*2][39m,
    _stack: [32m'D
atabaseClosedError:
 MissingAPIError 
IndexedDB API 
missing. Please 
visit https://tinyu
rl.com/y2uuvskb\n'
[39m +
      [32m'    at 
processTicksAndReje
ctions (node:intern
al/process/task_que
ues:103:5)\n'[39m 
+
      [32m'From 
previous: \n'[39m 
+
      [32m'    at 
Object.queueBucket 
(C:/Users/ibrab/Dow
nloads/app/harvestp
ro-nz (1)/src/servi
ces/offline.service
.ts:13:29)\n'[39m 
+
      [32m'    at 
Object.addBucket (C
:/Users/ibrab/Downl
oads/app/harvestpro
-nz (1)/src/stores/
useHarvestStore.ts:
305:32)\n'[39m +
      [32m'    at 
C:/Users/ibrab/Down
loads/app/harvestpr
o-nz (1)/src/stores
/__tests__/useHarve
stStore.test.ts:83:
32\n'[39m +
      [32m'    at 
C:\\Users\\ibrab\\D
ownloads\\app\\harv
estpro-nz (1)\\node
_modules\\@testing-
library\\react\\dis
t\\act-compat.js:47
:24\n'[39m +
      [32m'From 
previous: \n'[39m 
+
      [32m'    at 
new HarvestDB (C:/U
sers/ibrab/Download
s/app/harvestpro-nz
 (1)/src/services/d
b.ts:49:9)\n'[39m 
+
      [32m'    at 
C:/Users/ibrab/Down
loads/app/harvestpr
o-nz (1)/src/servic
es/db.ts:60:19\n'[
39m +
      [32m'    at 
processTicksAndReje
ctions (node:intern
al/process/task_que
ues:103:5)\n'[39m 
+
      [32m'    at 
VitestModuleEvaluat
or._runInlinedModul
e (file:///C:/Users
/ibrab/Downloads/ap
p/harvestpro-nz%20(
1)/node_modules/vit
est/dist/module-eva
luator.js:196:4)\n'
[39m +
      [32m'    at 
VitestModuleRunner.
directRequest (file
:///C:/Users/ibrab/
Downloads/app/harve
stpro-nz%20(1)/node
_modules/vite/dist/
node/module-runner.
js:1146:59)\n'[39m
 +
      [32m'    at 
VitestModuleRunner.
cachedRequest (file
:///C:/Users/ibrab/
Downloads/app/harve
stpro-nz%20(1)/node
_modules/vite/dist/
node/module-runner.
js:1053:73)\n'[39m
 +
      [32m'    at 
C:/Users/ibrab/Down
loads/app/harvestpr
o-nz (1)/src/servic
es/offline.service.
ts:1:2'[39m
  }
}

[90mstderr[2m | s
rc/stores/__tests__
/useHarvestStore.te
st.ts[2m > [22m[
2museHarvestStore 
- Phase 9 
Validations[2m > 
[22m[2maddBucket 
- Attendance 
Validation[2m > 
[22m[2mrejects 
bucket if picker 
archived
[22m[39m?? 
[Store] Rejected 
bucket ÔÇö picker 
Archived Picker is 
archived

[90mstderr[2m | s
rc/stores/__tests__
/useHarvestStore.te
st.ts[2m > [22m[
2museHarvestStore 
- Phase 9 
Validations[2m > 
[22m[2maddBucket 
- Timestamp 
Validation[2m > 
[22m[2mrejects 
bucket if clock 
skew > 5 minutes
[22m[39m?? 
[Store] REJECTED 
ÔÇö Device clock 
is 10 minutes off

[90mstderr[2m | s
rc/stores/__tests__
/useHarvestStore.te
st.ts[2m > [22m[
2museHarvestStore 
- Phase 9 
Validations[2m > 
[22m[2maddBucket 
- Timestamp 
Validation[2m > 
[22m[2maccepts 
bucket if clock 
skew < 5 minutes
[22m[39mUnhandled
 rejection: Databas
eClosedError: 
MissingAPIError 
IndexedDB API 
missing. Please 
visit https://tinyu
rl.com/y2uuvskb
    at 
Object.queueBucket 
(C:/Users/ibrab/Dow
nloads/app/harvestp
ro-nz (1)/src/servi
ces/offline.service
.ts:13:29)
    at 
Object.addBucket (C
:/Users/ibrab/Downl
oads/app/harvestpro
-nz (1)/src/stores/
useHarvestStore.ts:
305:32)
    at C:/Users/ibr
ab/Downloads/app/ha
rvestpro-nz (1)/src
/stores/__tests__/u
seHarvestStore.test
.ts:172:32
    at C:\Users\ibr
ab\Downloads\app\ha
rvestpro-nz (1)\nod
e_modules\@testing-
library\react\dist\
act-compat.js:47:24
    at process.env.
NODE_ENV.exports.ac
t (C:\Users\ibrab\D
ownloads\app\harves
tpro-nz (1)\node_mo
dules\react\cjs\rea
ct.development.js:8
14:22)
From previous: 
    at 
Object.queueBucket 
(C:/Users/ibrab/Dow
nloads/app/harvestp
ro-nz (1)/src/servi
ces/offline.service
.ts:13:29)
    at 
Object.addBucket (C
:/Users/ibrab/Downl
oads/app/harvestpro
-nz (1)/src/stores/
useHarvestStore.ts:
305:32)
    at C:/Users/ibr
ab/Downloads/app/ha
rvestpro-nz (1)/src
/stores/__tests__/u
seHarvestStore.test
.ts:172:32
    at C:\Users\ibr
ab\Downloads\app\ha
rvestpro-nz (1)\nod
e_modules\@testing-
library\react\dist\
act-compat.js:47:24
    at process.env.
NODE_ENV.exports.ac
t (C:\Users\ibrab\D
ownloads\app\harves
tpro-nz (1)\node_mo
dules\react\cjs\rea
ct.development.js:8
14:22)
    at C:\Users\ibr
ab\Downloads\app\ha
rvestpro-nz (1)\nod
e_modules\@testing-
library\react\dist\
act-compat.js:46:25
From previous: Data
baseClosedError: 
MissingAPIError 
IndexedDB API 
missing. Please 
visit https://tinyu
rl.com/y2uuvskb
    at 
Object.queueBucket 
(C:/Users/ibrab/Dow
nloads/app/harvestp
ro-nz (1)/src/servi
ces/offline.service
.ts:13:29)
    at 
Object.addBucket (C
:/Users/ibrab/Downl
oads/app/harvestpro
-nz (1)/src/stores/
useHarvestStore.ts:
305:32)
    at C:/Users/ibr
ab/Downloads/app/ha
rvestpro-nz (1)/src
/stores/__tests__/u
seHarvestStore.test
.ts:172:32
    at C:\Users\ibr
ab\Downloads\app\ha
rvestpro-nz (1)\nod
e_modules\@testing-
library\react\dist\
act-compat.js:47:24
    at process.env.
NODE_ENV.exports.ac
t (C:\Users\ibrab\D
ownloads\app\harves
tpro-nz (1)\node_mo
dules\react\cjs\rea
ct.development.js:8
14:22)
From previous: 
    at 
Object.queueBucket 
(C:/Users/ibrab/Dow
nloads/app/harvestp
ro-nz (1)/src/servi
ces/offline.service
.ts:13:29)
    at 
Object.addBucket (C
:/Users/ibrab/Downl
oads/app/harvestpro
-nz (1)/src/stores/
useHarvestStore.ts:
305:32)
    at C:/Users/ibr
ab/Downloads/app/ha
rvestpro-nz (1)/src
/stores/__tests__/u
seHarvestStore.test
.ts:172:32
    at C:\Users\ibr
ab\Downloads\app\ha
rvestpro-nz (1)\nod
e_modules\@testing-
library\react\dist\
act-compat.js:47:24

[90mstderr[2m | s
rc/stores/__tests__
/useHarvestStore.te
st.ts[2m > [22m[
2museHarvestStore 
- Phase 9 
Validations[2m > 
[22m[2maddBucket 
- Timestamp 
Validation[2m > 
[22m[2maccepts 
bucket if clock 
skew < 5 minutes
[22m[39m├ó┬Ø┼Æ 
[Offline] Failed 
to queue bucket: 
[36m<ref *2>[39m 
DexieError [Databas
eClosedError]: 
MissingAPIError 
IndexedDB API 
missing. Please 
visit https://tinyu
rl.com/y2uuvskb
    at 
Object.queueBucket 
(C:/Users/ibrab/Dow
nloads/app/harvestp
ro-nz (1)/src/servi
ces/offline.service
.ts:13:29)
    at 
Object.addBucket (C
:/Users/ibrab/Downl
oads/app/harvestpro
-nz (1)/src/stores/
useHarvestStore.ts:
305:32)
    at C:/Users/ibr
ab/Downloads/app/ha
rvestpro-nz (1)/src
/stores/__tests__/u
seHarvestStore.test
.ts:172:32
    at [90mC:\User
s\ibrab\Downloads\a
pp\harvestpro-nz (1
)\[39mnode_modules
\[4m@testing-libra
ry\react[24m\dist\
act-compat.js:47:24
    at process.env.
NODE_ENV.exports.ac
t [90m(C:\Users\ib
rab\Downloads\app\h
arvestpro-nz (1)\[
39mnode_modules\[4
mreact[24m\cjs\rea
ct.development.js:8
14:22[90m)[39m
From previous: 
    at 
Object.queueBucket 
(C:/Users/ibrab/Dow
nloads/app/harvestp
ro-nz (1)/src/servi
ces/offline.service
.ts:13:29)
    at 
Object.addBucket (C
:/Users/ibrab/Downl
oads/app/harvestpro
-nz (1)/src/stores/
useHarvestStore.ts:
305:32)
    at C:/Users/ibr
ab/Downloads/app/ha
rvestpro-nz (1)/src
/stores/__tests__/u
seHarvestStore.test
.ts:172:32
    at [90mC:\User
s\ibrab\Downloads\a
pp\harvestpro-nz (1
)\[39mnode_modules
\[4m@testing-libra
ry\react[24m\dist\
act-compat.js:47:24
    at process.env.
NODE_ENV.exports.ac
t [90m(C:\Users\ib
rab\Downloads\app\h
arvestpro-nz (1)\[
39mnode_modules\[4
mreact[24m\cjs\rea
ct.development.js:8
14:22[90m)[39m
    at [90mC:\User
s\ibrab\Downloads\a
pp\harvestpro-nz (1
)\[39mnode_modules
\[4m@testing-libra
ry\react[24m\dist\
act-compat.js:46:25
From previous: Data
baseClosedError: 
MissingAPIError 
IndexedDB API 
missing. Please 
visit https://tinyu
rl.com/y2uuvskb
    at 
Object.queueBucket 
(C:/Users/ibrab/Dow
nloads/app/harvestp
ro-nz (1)/src/servi
ces/offline.service
.ts:13:29)
    at 
Object.addBucket (C
:/Users/ibrab/Downl
oads/app/harvestpro
-nz (1)/src/stores/
useHarvestStore.ts:
305:32)
    at C:/Users/ibr
ab/Downloads/app/ha
rvestpro-nz (1)/src
/stores/__tests__/u
seHarvestStore.test
.ts:172:32
    at [90mC:\User
s\ibrab\Downloads\a
pp\harvestpro-nz (1
)\[39mnode_modules
\[4m@testing-libra
ry\react[24m\dist\
act-compat.js:47:24
    at process.env.
NODE_ENV.exports.ac
t [90m(C:\Users\ib
rab\Downloads\app\h
arvestpro-nz (1)\[
39mnode_modules\[4
mreact[24m\cjs\rea
ct.development.js:8
14:22[90m)[39m
From previous: 
    at 
Object.queueBucket 
(C:/Users/ibrab/Dow
nloads/app/harvestp
ro-nz (1)/src/servi
ces/offline.service
.ts:13:29)
    at 
Object.addBucket (C
:/Users/ibrab/Downl
oads/app/harvestpro
-nz (1)/src/stores/
useHarvestStore.ts:
305:32)
    at C:/Users/ibr
ab/Downloads/app/ha
rvestpro-nz (1)/src
/stores/__tests__/u
seHarvestStore.test
.ts:172:32
    at [90mC:\User
s\ibrab\Downloads\a
pp\harvestpro-nz (1
)\[39mnode_modules
\[4m@testing-libra
ry\react[24m\dist\
act-compat.js:47:24
 {
  _e: Error: 
      at 
getErrorWithStack 
[90m(C:\Users\ibrab
\Downloads\app\harv
estpro-nz (1)\[39m
node_modules\[4mde
xie[24m\dist\dexie
.js:324:16[90m)[3
9m
      at new 
DexieError [90m(C:
\Users\ibrab\Downlo
ads\app\harvestpro-
nz (1)\[39mnode_mo
dules\[4mdexie[24
m\dist\dexie.js:423
:23[90m)[39m
      at 
tempTransaction [9
0m(C:\Users\ibrab\D
ownloads\app\harves
tpro-nz (1)\[39mno
de_modules\[4mdexi
e[24m\dist\dexie.j
s:1256:34[90m)[39
m
      at 
Table._trans [90m(
C:\Users\ibrab\Down
loads\app\harvestpr
o-nz (1)\[39mnode_
modules\[4mdexie[
24m\dist\dexie.js:1
349:21[90m)[39m
      at Table.put 
[90m(C:\Users\ibra
b\Downloads\app\har
vestpro-nz (1)\[39
mnode_modules\[4md
exie[24m\dist\dexi
e.js:1533:25[90m)
[39m
      at 
Object.queueBucket 
(C:/Users/ibrab/Dow
nloads/app/harvestp
ro-nz (1)/src/servi
ces/offline.service
.ts:13:29)
      at 
Object.addBucket (C
:/Users/ibrab/Downl
oads/app/harvestpro
-nz (1)/src/stores/
useHarvestStore.ts:
305:32)
      at C:/Users/i
brab/Downloads/app/
harvestpro-nz (1)/s
rc/stores/__tests__
/useHarvestStore.te
st.ts:172:32
      at [90mC:\Us
ers\ibrab\Downloads
\app\harvestpro-nz 
(1)\[39mnode_modul
es\[4m@testing-lib
rary\react[24m\dis
t\act-compat.js:47:
24
      at process.en
v.NODE_ENV.exports.
act [90m(C:\Users\
ibrab\Downloads\app
\harvestpro-nz (1)\
[39mnode_modules\
[4mreact[24m\cjs\r
eact.development.js
:814:22[90m)[39m,
  inner: [36m<ref 
*1>[39m 
DexieError 
[MissingAPIError]: 
IndexedDB API 
missing. Please 
visit https://tinyu
rl.com/y2uuvskb
  [90m    at proce
ssTicksAndRejection
s (node:internal/pr
ocess/task_queues:1
03:5)[39m
  From previous: 
  [90m    at proce
ssTicksAndRejection
s (node:internal/pr
ocess/task_queues:1
03:5)[39m {
    _e: Error: 
        at 
getErrorWithStack 
[90m(C:\Users\ibrab
\Downloads\app\harv
estpro-nz (1)\[39m
node_modules\[4mde
xie[24m\dist\dexie
.js:324:16[90m)[3
9m
        at new 
DexieError [90m(C:
\Users\ibrab\Downlo
ads\app\harvestpro-
nz (1)\[39mnode_mo
dules\[4mdexie[24
m\dist\dexie.js:423
:23[90m)[39m
        at [90mC:\
Users\ibrab\Downloa
ds\app\harvestpro-n
z (1)\[39mnode_mod
ules\[4mdexie[24m
\dist\dexie.js:3747
:23
        at 
executePromiseTask 
[90m(C:\Users\ibra
b\Downloads\app\har
vestpro-nz (1)\[39
mnode_modules\[4md
exie[24m\dist\dexi
e.js:840:13[90m)[
39m
        at new 
DexiePromise [90m(
C:\Users\ibrab\Down
loads\app\harvestpr
o-nz (1)\[39mnode_
modules\[4mdexie[
24m\dist\dexie.js:6
54:9[90m)[39m
        at 
tryOpenDB [90m(C:\
Users\ibrab\Downloa
ds\app\harvestpro-n
z (1)\[39mnode_mod
ules\[4mdexie[24m
\dist\dexie.js:3744
:46[90m)[39m
    [90m    at pro
cessTicksAndRejecti
ons (node:internal/
process/task_queues
:103:5)[39m,
    inner: 
[1mnull[22m,
    _promise: 
DexiePromise 
[Dexie.Promise] {
      _listeners: 
[],
      onuncatched: 
[36m[Function: 
nop][39m,
      _lib: 
[33mfalse[39m,
      _PSD: 
[36m[Object][39m,
      
_stackHolder: 
Error: 
          at 
getErrorWithStack 
[90m(C:\Users\ibrab
\Downloads\app\harv
estpro-nz (1)\[39m
node_modules\[4mde
xie[24m\dist\dexie
.js:324:16[90m)[3
9m
          at new 
DexiePromise [90m(
C:\Users\ibrab\Down
loads\app\harvestpr
o-nz (1)\[39mnode_
modules\[4mdexie[
24m\dist\dexie.js:6
38:33[90m)[39m
          at 
tryOpenDB [90m(C:\
Users\ibrab\Downloa
ds\app\harvestpro-n
z (1)\[39mnode_mod
ules\[4mdexie[24m
\dist\dexie.js:3744
:46[90m)[39m
      [90m    at p
rocessTicksAndRejec
tions (node:interna
l/process/task_queu
es:103:5)[39m,
      _prev: 
[1mnull[22m,
      _numPrev: 
[33m0[39m,
      _state: 
[33mfalse[39m,
      _value: 
[36m[Circular 
*1][39m,
      _stack: [32m
'MissingAPIError: 
IndexedDB API 
missing. Please 
visit https://tinyu
rl.com/y2uuvskb\n'
[39m +
        [32m'    
at processTicksAndR
ejections (node:int
ernal/process/task_
queues:103:5)\n'[3
9m +
        [32m'From 
previous: \n'[39m 
+
        [32m'    
at processTicksAndR
ejections (node:int
ernal/process/task_
queues:103:5)'[39m
    },
    _stack: [32m'M
issingAPIError: 
IndexedDB API 
missing. Please 
visit https://tinyu
rl.com/y2uuvskb\n'
[39m +
      [32m'    at 
processTicksAndReje
ctions (node:intern
al/process/task_que
ues:103:5)'[39m
  },
  _promise: 
DexiePromise 
[Dexie.Promise] {
    _listeners: [],
    onuncatched: 
[36m[Function: 
nop][39m,
    _lib: 
[33mfalse[39m,
    _PSD: {
      id: 
[32m'global'[39m,
      global: 
[33mtrue[39m,
      ref: 
[33m4[39m,
      unhandleds: 
[],
      onunhandled: 
[36m[Function: 
globalError][39m,
      pgp: 
[33mfalse[39m,
      env: 
[36m[Object][39m,
      finalize: 
[36m[Function: 
finalize][39m
    },
    _stackHolder: 
Error: 
        at 
getErrorWithStack 
[90m(C:\Users\ibrab
\Downloads\app\harv
estpro-nz (1)\[39m
node_modules\[4mde
xie[24m\dist\dexie
.js:324:16[90m)[3
9m
        at new 
DexiePromise [90m(
C:\Users\ibrab\Down
loads\app\harvestpr
o-nz (1)\[39mnode_
modules\[4mdexie[
24m\dist\dexie.js:6
38:33[90m)[39m
        at 
DexiePromise.then 
[90m(C:\Users\ibrab
\Downloads\app\harv
estpro-nz (1)\[39m
node_modules\[4mde
xie[24m\dist\dexie
.js:663:26[90m)[3
9m
        at 
Table.put [90m(C:\
Users\ibrab\Downloa
ds\app\harvestpro-n
z (1)\[39mnode_mod
ules\[4mdexie[24m
\dist\dexie.js:1534
:18[90m)[39m
        at 
Object.queueBucket 
(C:/Users/ibrab/Dow
nloads/app/harvestp
ro-nz (1)/src/servi
ces/offline.service
.ts:13:29)
        at 
Object.addBucket (C
:/Users/ibrab/Downl
oads/app/harvestpro
-nz (1)/src/stores/
useHarvestStore.ts:
305:32)
        at C:/Users
/ibrab/Downloads/ap
p/harvestpro-nz (1)
/src/stores/__tests
__/useHarvestStore.
test.ts:172:32
        at [90mC:\
Users\ibrab\Downloa
ds\app\harvestpro-n
z (1)\[39mnode_mod
ules\[4m@testing-l
ibrary\react[24m\d
ist\act-compat.js:4
7:24
        at process.
env.NODE_ENV.export
s.act [90m(C:\User
s\ibrab\Downloads\a
pp\harvestpro-nz (1
)\[39mnode_modules
\[4mreact[24m\cjs
\react.development.
js:814:22[90m)[39
m
        at [90mC:\
Users\ibrab\Downloa
ds\app\harvestpro-n
z (1)\[39mnode_mod
ules\[4m@testing-l
ibrary\react[24m\d
ist\act-compat.js:4
6:25,
    _prev: 
DexiePromise 
[Dexie.Promise] {
      _listeners: 
[],
      onuncatched: 
[36m[Function: 
nop][39m,
      _lib: 
[33mfalse[39m,
      _PSD: 
[36m[Object][39m,
      
_stackHolder: 
Error: 
          at 
getErrorWithStack 
[90m(C:\Users\ibrab
\Downloads\app\harv
estpro-nz (1)\[39m
node_modules\[4mde
xie[24m\dist\dexie
.js:324:16[90m)[3
9m
          at new 
DexiePromise [90m(
C:\Users\ibrab\Down
loads\app\harvestpr
o-nz (1)\[39mnode_
modules\[4mdexie[
24m\dist\dexie.js:6
38:33[90m)[39m
          at 
PromiseReject [90m
(C:\Users\ibrab\Dow
nloads\app\harvestp
ro-nz (1)\[39mnode
_modules\[4mdexie
[24m\dist\dexie.js:
1041:16[90m)[39m
          at 
tempTransaction [9
0m(C:\Users\ibrab\D
ownloads\app\harves
tpro-nz (1)\[39mno
de_modules\[4mdexi
e[24m\dist\dexie.j
s:1256:24[90m)[39
m
          at 
Table._trans [90m(
C:\Users\ibrab\Down
loads\app\harvestpr
o-nz (1)\[39mnode_
modules\[4mdexie[
24m\dist\dexie.js:1
349:21[90m)[39m
          at 
Table.put [90m(C:\
Users\ibrab\Downloa
ds\app\harvestpro-n
z (1)\[39mnode_mod
ules\[4mdexie[24m
\dist\dexie.js:1533
:25[90m)[39m
          at 
Object.queueBucket 
(C:/Users/ibrab/Dow
nloads/app/harvestp
ro-nz (1)/src/servi
ces/offline.service
.ts:13:29)
          at 
Object.addBucket (C
:/Users/ibrab/Downl
oads/app/harvestpro
-nz (1)/src/stores/
useHarvestStore.ts:
305:32)
          at C:/Use
rs/ibrab/Downloads/
app/harvestpro-nz (
1)/src/stores/__tes
ts__/useHarvestStor
e.test.ts:172:32
          at [90mC
:\Users\ibrab\Downl
oads\app\harvestpro
-nz (1)\[39mnode_m
odules\[4m@testing
-library\react[24m
\dist\act-compat.js
:47:24,
      _prev: 
[1mnull[22m,
      _numPrev: 
[33m0[39m,
      _state: 
[33mfalse[39m,
      _value: 
[36m[Circular 
*2][39m
    },
    _numPrev: 
[33m1[39m,
    _state: 
[33mfalse[39m,
    _value: 
[36m[Circular 
*2][39m,
    _stack: [32m'D
atabaseClosedError:
 MissingAPIError 
IndexedDB API 
missing. Please 
visit https://tinyu
rl.com/y2uuvskb\n'
[39m +
      [32m'    at 
Object.queueBucket 
(C:/Users/ibrab/Dow
nloads/app/harvestp
ro-nz (1)/src/servi
ces/offline.service
.ts:13:29)\n'[39m 
+
      [32m'    at 
Object.addBucket (C
:/Users/ibrab/Downl
oads/app/harvestpro
-nz (1)/src/stores/
useHarvestStore.ts:
305:32)\n'[39m +
      [32m'    at 
C:/Users/ibrab/Down
loads/app/harvestpr
o-nz (1)/src/stores
/__tests__/useHarve
stStore.test.ts:172
:32\n'[39m +
      [32m'    at 
C:\\Users\\ibrab\\D
ownloads\\app\\harv
estpro-nz (1)\\node
_modules\\@testing-
library\\react\\dis
t\\act-compat.js:47
:24\n'[39m +
      [32m'    at 
process.env.NODE_EN
V.exports.act (C:\\
Users\\ibrab\\Downl
oads\\app\\harvestp
ro-nz (1)\\node_mod
ules\\react\\cjs\\r
eact.development.js
:814:22)\n'[39m +
      [32m'From 
previous: \n'[39m 
+
      [32m'    at 
Object.queueBucket 
(C:/Users/ibrab/Dow
nloads/app/harvestp
ro-nz (1)/src/servi
ces/offline.service
.ts:13:29)\n'[39m 
+
      [32m'    at 
Object.addBucket (C
:/Users/ibrab/Downl
oads/app/harvestpro
-nz (1)/src/stores/
useHarvestStore.ts:
305:32)\n'[39m +
      [32m'    at 
C:/Users/ibrab/Down
loads/app/harvestpr
o-nz (1)/src/stores
/__tests__/useHarve
stStore.test.ts:172
:32\n'[39m +
      [32m'    at 
C:\\Users\\ibrab\\D
ownloads\\app\\harv
estpro-nz (1)\\node
_modules\\@testing-
library\\react\\dis
t\\act-compat.js:47
:24\n'[39m +
      [32m'    at 
process.env.NODE_EN
V.exports.act (C:\\
Users\\ibrab\\Downl
oads\\app\\harvestp
ro-nz (1)\\node_mod
ules\\react\\cjs\\r
eact.development.js
:814:22)\n'[39m +
 [31mÔØ»[39m src/stores/__tests__/useHarvestStore.test.ts [2m([22m[2m8 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 65[2mms[22m[39m
       [32mÔ£ô[39m rejects bucket if picker not checked in[32m 22[2mms[22m[39m
       [32mÔ£ô[39m accepts bucket if picker checked in[32m 16[2mms[22m[39m
       [32mÔ£ô[39m rejects bucket if picker archived[32m 3[2mms[22m[39m
       [32mÔ£ô[39m rejects bucket if clock skew > 5 minutes[32m 2[2mms[22m[39m
       [32mÔ£ô[39m accepts bucket if clock skew < 5 minutes[32m 5[2mms[22m[39m
       [32mÔ£ô[39m excludes archived pickers from payroll[32m 2[2mms[22m[39m
[31m       [31m├ù[31m initializes with correct default clockSkew[39m[32m 10[2mms[22m[39m
       [32mÔ£ô[39m stores serverTimestamp on fetch[32m 1[2mms[22m[39m

[2m Test Files [22m [1m[31m1 failed[39m[22m[2m | [22m[1m[32m4 passed[39m[22m[90m (5)[39m
[2m      Tests [22m [1m[31m1 failed[39m[22m[2m | [22m[1m[32m71 passed[39m[22m[90m (72)[39m
[2m   Start at [22m 23:55:17
[2m   Duration [22m 2.77s[2m (transform 523ms, setup 0ms, import 1.11s, tests 101ms, environment 4.61s)[22m

      [32m'    at 
C:\\Users\\ibrab\\D
ownloads\\app\\harv
estpro-nz (1)\\node
_modules\\@testing-
library\\react\\dis
t\\act-compat.js:46
:25\n'[39m +
      [32m'From 
previous: DatabaseC
losedError: 
MissingAPIError 
IndexedDB API 
missing. Please 
visit https://tinyu
rl.com/y2uuvskb\n'
[39m +
      [32m'    at 
Object.queueBucket 
(C:/Users/ibrab/Dow
nloads/app/harvestp
ro-nz (1)/src/servi
ces/offline.service
.ts:13:29)\n'[39m 
+
      [32m'    at 
Object.addBucket (C
:/Users/ibrab/Downl
oads/app/harvestpro
-nz (1)/src/stores/
useHarvestStore.ts:
305:32)\n'[39m +
      [32m'    at 
C:/Users/ibrab/Down
loads/app/harvestpr
o-nz (1)/src/stores
/__tests__/useHarve
stStore.test.ts:172
:32\n'[39m +
      [32m'    at 
C:\\Users\\ibrab\\D
ownloads\\app\\harv
estpro-nz (1)\\node
_modules\\@testing-
library\\react\\dis
t\\act-compat.js:47
:24\n'[39m +
      [32m'    at 
process.env.NODE_EN
V.exports.act (C:\\
Users\\ibrab\\Downl
oads\\app\\harvestp
ro-nz (1)\\node_mod
ules\\react\\cjs\\r
eact.development.js
:814:22)\n'[39m +
      [32m'From 
previous: \n'[39m 
+
      [32m'    at 
Object.queueBucket 
(C:/Users/ibrab/Dow
nloads/app/harvestp
ro-nz (1)/src/servi
ces/offline.service
.ts:13:29)\n'[39m 
+
      [32m'    at 
Object.addBucket (C
:/Users/ibrab/Downl
oads/app/harvestpro
-nz (1)/src/stores/
useHarvestStore.ts:
305:32)\n'[39m +
      [32m'    at 
C:/Users/ibrab/Down
loads/app/harvestpr
o-nz (1)/src/stores
/__tests__/useHarve
stStore.test.ts:172
:32\n'[39m +
      [32m'    at 
C:\\Users\\ibrab\\D
ownloads\\app\\harv
estpro-nz (1)\\node
_modules\\@testing-
library\\react\\dis
t\\act-compat.js:47
:24'[39m
  },
  _stack: [32m'Dat
abaseClosedError: 
MissingAPIError 
IndexedDB API 
missing. Please 
visit https://tinyu
rl.com/y2uuvskb\n'
[39m +
    [32m'    at 
Object.queueBucket 
(C:/Users/ibrab/Dow
nloads/app/harvestp
ro-nz (1)/src/servi
ces/offline.service
.ts:13:29)\n'[39m 
+
    [32m'    at 
Object.addBucket (C
:/Users/ibrab/Downl
oads/app/harvestpro
-nz (1)/src/stores/
useHarvestStore.ts:
305:32)\n'[39m +
    [32m'    at C:
/Users/ibrab/Downlo
ads/app/harvestpro-
nz (1)/src/stores/_
_tests__/useHarvest
Store.test.ts:172:3
2\n'[39m +
    [32m'    at C:
\\Users\\ibrab\\Dow
nloads\\app\\harves
tpro-nz (1)\\node_m
odules\\@testing-li
brary\\react\\dist\
\act-compat.js:47:2
4\n'[39m +
    [32m'    at pr
ocess.env.NODE_ENV.
exports.act (C:\\Us
ers\\ibrab\\Downloa
ds\\app\\harvestpro
-nz (1)\\node_modul
es\\react\\cjs\\rea
ct.development.js:8
14:22)'[39m
}


[31mÔÄ»ÔÄ»ÔÄ»ÔÄ»ÔÄ
»ÔÄ»ÔÄ»[39m[1m[4
1m Failed Tests 1 
[49m[22m[31mÔÄ»ÔÄ
»ÔÄ»ÔÄ»ÔÄ»ÔÄ»ÔÄ»[3
9m

[41m[1m FAIL 
[22m[49m src/stor
es/__tests__/useHar
vestStore.test.ts[
2m > [22museHarves
tStore - Phase 9 
Validations[2m > 
[22mState 
Management[2m > 
[22minitializes 
with correct 
default clockSkew
[31m[1mAssertionE
rror[22m: 
expected 120000 to 
be +0 // Object.is 
equality[39m

[32m- 
Expected[39m
[31m+ 
Received[39m

[32m- 0[39m
[31m+ 120000[39m

[36m [2mÔØ»[22m 
src/stores/__tests_
_/useHarvestStore.t
est.ts:[2m238:46[
22m[39m
    [90m236| [39m
    [90m237| 
[39m            [
34mexpect[39m(resu
lt[33m.[39mcurren
t[33m.[39mclockSk
ew)[33m.[39m[34m
toBeDefined[39m()
[33m;[39m
    [90m238| 
[39m            [
34mexpect[39m(resu
lt[33m.[39mcurren
t[33m.[39mclockSk
ew)[33m.[39m[34m
toBe[39m([34m0[3
9m)[33m;[39m
    [90m   | 
[39m              
                   
            
[31m^[39m
    [90m239| 
[39m        
})[33m;[39m
    [90m240| [39m

[31m[2mÔÄ»ÔÄ»ÔÄ»Ô
Ä»ÔÄ»ÔÄ»ÔÄ»ÔÄ»ÔÄ»ÔÄ
»ÔÄ»ÔÄ»ÔÄ»ÔÄ»ÔÄ»ÔÄ»
ÔÄ»ÔÄ»ÔÄ»ÔÄ»ÔÄ»ÔÄ»Ô
Ä»ÔÄ»[1/1]ÔÄ»[22m
[39m

